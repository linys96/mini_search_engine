# 搜索引擎
## 1. 开发环境
Linux: Ubuntu 18.04
G++: Version 7.5.0
Vim: 8.0

## 2. 系统目录结构
- offline: 存放离线阶段相关文件
    - src: 存放源文件
    - include: 存放头文件
    - conf: 存放配置文件
    - data: 存放生成的网页库、偏移库、倒排索引文件
    - dict: cppjieba所需的词典文件
    - rss: 待处理的rss网页文件
- online: 存放在线阶段相关文件
    - src: 存放源文件
    - include: 存放头文件
    - conf: 存放配置文件
    - data: 存放离线阶段生成的网页库、偏移库、倒排索引文件
    - dict: cppjieba所需的词典文件
    - php_TCP: php客户端相关文件
## 3. 项目功能
### 3.1 离线阶段

1. 建立网页库和网页偏移库
    用tinyxml2对rss网页文件进行处理，读取网页标题、内容、链接，将其保存为网页库文件，并记录每篇文档的位置信息，即为网页偏移库。
2. 网页去重，并生成去重后的网页库和网页偏移库
    用simhash对网页进行去重，并生成去重后的网页库和网页偏移库。
3. 建立倒排索引
    根据TF-IDF算法建立倒排索引：将单词作为索引，将文档ID作为记录，可以方便地通过单词查找其所在的文档。
        TF: Term Frequency, 某个词在文章中出现的次数；
        DF: Document Frequency, 某个词在所有文章中出现的次数，即包含该词语的文档数量；
        IDF: Inverse Document Frequency, 逆文档频率，表示该词对于该篇文章的重要性的一个系数，其计算公式为：
            IDF= log2(N/(DF+1))，其中N表示文档的总数或网页库的文档数
    最后，词语的权重w则为：
            w = TF * IDF
    而一篇文档包含多个词语w1,w2,...,wn，还需要对这些词语的权重系数进行归一化处理，其计算公式如下：
            w' = w /sqrt(w1^2 + w2^2 +...+ wn^2)

### 3.2 在线阶段

1. 服务器模块：启动服务器，进入监听状态，等待客户端连接
2. 线程池模块：将客户端的请求封装成任务，交给线程池处理
3. 查询模块：提供网页查询服务
    查询策略：
    （1）在处理查询请求时，对于查询的关键词，将它们视为一篇文档X，通过TF-IDF算法计算出每个关键词的权重系数；将其组成一个向量(x1, x2, ...,xn)，该向量作为基准向量Base，在下面的(3)中使用；
    （2）通过倒排索引表去查找包含所有关键字的网页；只要其中有一个查询词不在索引表中，就认为没有找到相关的网页；
    （3）如果找到了网页，则用余弦相似度对查找到的网页进行排序。既然查找到的网页都包含查询词，那么获取每个查询词的w，将它们组成一个向量Y = (y1,y2, ... yn)，用该向量代表这篇网页，该向量Y是网页的特征，
    然后计算它与Base的余弦值，该余弦值代表的就是Y与X的相似度；那么现在只需要将查找到的所有网页都与X进行余弦相似度cosθ的计算，然后根据cosθ的大小进行排序，cosθ越大越相似，这样的网页应该出现在前排的位置。
    cosθ的计算方法如下：
            X * Y = (x1 * y1 + x2 * y2 + x3 * y3)
            cosθ = (X * Y) / (|X| * |Y|)
    （4）当找到网页之后，还需要提取每篇网页中的标题和摘要信息，然后将这些信息用开源库jsoncpp封装成一个JSON字符串，交给服务器框架模块去发送给客户端。